# YOLOv8 Student configuration (based on YOLOv8-Small)
# Modifications:
# - Channel reduction: width_multiple = 0.25
# - P2 Head: produce an additional high-resolution (stride=4) output
# - Replace the C2f block before SPPF with C2f_TRT (defined in src/detector.py)

nc: 80
depth_multiple: 0.33
width_multiple: 0.25

# Backbone and head follow the ultralytics/YOLOv8 style layer list.
# Each entry: [from, number, module, args]
backbone:
  # low-level features -> higher-level
  [[-1, 1, Conv, [32, 3, 1]],
   [-1, 1, C2f, [64, 3]],
   [-1, 1, Conv, [128, 3, 2]],
   [-1, 3, C2f, [128, 3]],
   [-1, 1, Conv, [256, 3, 2]],
   [-1, 3, C2f, [256, 3]],
   [-1, 1, Conv, [512, 3, 2]],
   # Replace the C2f before SPPF with the lightweight Transformer-backed block
   [-1, 1, C2f_TRT, [512, 3]],
   [-1, 1, SPPF, [512, 5]]]

head:
  # head now produces P2 (stride=4), P3 (8), P4 (16), P5 (32)
  [[-1, 1, Conv, [256, 1, 1]],
   [-1, 1, Upsample, [2]],
   [[-1, 4], 1, Concat, [1]],
   [-1, 3, C2f, [256, 3]],
   # high-resolution branch (P2): connect an earlier feature map (stride=4)
   [-3, 1, Conv, [128, 1, 1]],
   [-1, 1, Conv, [128, 3, 1]],
   [-1, 1, C2f, [128, 3]],
   # remaining pyramid levels
   [-2, 1, Upsample, [2]],
   [[-1, 2], 1, Concat, [1]],
   [-1, 3, C2f, [256, 3]],
   [-1, 1, Conv, [256, 3, 2]],
   [[-1, 4], 1, Concat, [1]],
   [-1, 3, C2f, [512, 3]],
   # Detection layer: anchors are left generic; ultralytics will adapt at training time
   [-1, 1, Detect, [nc, [[10,13, 16,30, 33,23], [30,61, 62,45, 59,119], [116,90, 156,198, 373,326]]]]
